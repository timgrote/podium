<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              primary: '#6c63ff',
              'primary-hover': '#5a52d5',
              'dark-bg': '#1a1a2e',
              'dark-card': '#242442',
              'dark-border': '#444',
              'green-brand': '#2c5530',
              'green-brand-hover': '#1e3d22',
            }
          }
        }
      }
    </script>
    <title>Podium - Submit Proposal</title>
</head>
<body class="font-sans leading-relaxed text-gray-700 bg-dark-bg min-h-screen">
    <div class="max-w-[600px] mx-auto py-10 px-5">
        <header class="text-center mb-10">
            <h1 class="text-3xl text-white mb-2.5">Podium <span class="bg-primary text-white py-1 px-3 rounded-full text-xs ml-2.5">Designer</span></h1>
            <p class="text-gray-500 text-base">Submit Proposal to Client</p>
        </header>

        <div class="bg-dark-card rounded-xl p-8 shadow-[0_4px_24px_rgba(0,0,0,0.3)]">
            <form id="proposal-form">
                <div class="mb-5">
                    <label for="job_id" class="block mb-1.5 font-medium text-gray-400">Job Reference</label>
                    <input type="text" id="job_id" name="job_id" required
                           placeholder="e.g., 2026-001 or project name"
                           class="w-full p-3 border border-dark-border rounded-md text-base bg-dark-bg text-white transition-colors focus:outline-none focus:border-primary">
                </div>

                <div class="flex gap-4">
                    <div class="mb-5 flex-1">
                        <label for="client_name" class="block mb-1.5 font-medium text-gray-400">Client Name</label>
                        <input type="text" id="client_name" name="client_name" required
                               placeholder="Client's name"
                               class="w-full p-3 border border-dark-border rounded-md text-base bg-dark-bg text-white transition-colors focus:outline-none focus:border-primary">
                    </div>
                    <div class="mb-5 flex-1">
                        <label for="client_email" class="block mb-1.5 font-medium text-gray-400">Client Email</label>
                        <input type="email" id="client_email" name="client_email" required
                               placeholder="client@example.com"
                               class="w-full p-3 border border-dark-border rounded-md text-base bg-dark-bg text-white transition-colors focus:outline-none focus:border-primary">
                    </div>
                </div>

                <div class="mb-5">
                    <label for="project_name" class="block mb-1.5 font-medium text-gray-400">Project Name</label>
                    <input type="text" id="project_name" name="project_name" required
                           placeholder="Gateway Residence Irrigation"
                           class="w-full p-3 border border-dark-border rounded-md text-base bg-dark-bg text-white transition-colors focus:outline-none focus:border-primary">
                </div>

                <div class="flex gap-4">
                    <div class="mb-5 flex-1">
                        <label for="amount" class="block mb-1.5 font-medium text-gray-400">Quote Amount ($)</label>
                        <input type="number" id="amount" name="amount" required
                               placeholder="2500" min="0" step="0.01"
                               class="w-full p-3 border border-dark-border rounded-md text-base bg-dark-bg text-white transition-colors focus:outline-none focus:border-primary">
                    </div>
                    <div class="mb-5 flex-1">
                        <label for="turnaround" class="block mb-1.5 font-medium text-gray-400">Turnaround (days)</label>
                        <input type="number" id="turnaround" name="turnaround"
                               placeholder="5" min="1" value="5"
                               class="w-full p-3 border border-dark-border rounded-md text-base bg-dark-bg text-white transition-colors focus:outline-none focus:border-primary">
                    </div>
                </div>

                <div class="mb-5">
                    <label for="scope" class="block mb-1.5 font-medium text-gray-400">Scope of Work</label>
                    <textarea id="scope" name="scope" required
                              placeholder="Describe what's included in this quote..."
                              class="w-full p-3 border border-dark-border rounded-md text-base bg-dark-bg text-white transition-colors focus:outline-none focus:border-primary min-h-[100px] resize-y"></textarea>
                </div>

                <div class="mb-5">
                    <label class="block mb-1.5 font-medium text-gray-400">Proposal PDF (optional)</label>
                    <div class="border-2 border-dashed border-dark-border rounded-md p-6 text-center cursor-pointer transition-colors hover:border-primary" onclick="document.getElementById('file').click()">
                        <input type="file" id="file" name="proposal_pdf" accept=".pdf" class="hidden">
                        <div class="text-gray-500">Click to attach proposal document</div>
                        <div class="text-sm text-gray-600 mt-2">PDF format</div>
                        <div class="mt-2.5 text-primary font-medium" id="file-name"></div>
                    </div>
                </div>

                <button type="submit" class="w-full py-3.5 bg-primary text-white border-none rounded-md text-lg font-medium cursor-pointer transition-colors hover:bg-primary-hover disabled:bg-dark-border disabled:cursor-not-allowed">Send Proposal to Client</button>
            </form>

            <div class="hidden text-center py-10 px-5 text-white" id="success">
                <h2 class="text-primary mb-2.5">Proposal Sent!</h2>
                <p>The client will receive an email with the proposal and contract link.</p>
            </div>
        </div>
    </div>

    <script>
        const form = document.getElementById('proposal-form');
        const fileInput = document.getElementById('file');
        const fileName = document.getElementById('file-name');
        const success = document.getElementById('success');

        fileInput.addEventListener('change', (e) => {
            if (e.target.files.length > 0) {
                fileName.textContent = e.target.files[0].name;
            }
        });

        form.addEventListener('submit', async (e) => {
            e.preventDefault();
            const button = form.querySelector('button');
            button.disabled = true;
            button.textContent = 'Sending...';

            const formData = new FormData(form);

            try {
                const response = await fetch('/api/flows/proposals', {
                    method: 'POST',
                    body: formData
                });

                if (response.ok) {
                    form.style.display = 'none';
                    success.style.display = 'block';
                } else {
                    throw new Error('Submission failed');
                }
            } catch (error) {
                alert('Something went wrong. Please try again.');
                button.disabled = false;
                button.textContent = 'Send Proposal to Client';
            }
        });
    </script>
</body>
</html>
